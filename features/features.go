package features

// Taken from https://docs.google.com/spreadsheets/d/1CfTEmDsjnuh_flWhSFVZ6wqWR7m7egeyVD6BXppgCyE/edit#gid=1074788665

// Default global checklist.
// Helper template function for randomized testing.
var List = Checklist{}

type Checklist struct {
	// TODO: Check this with Rahul? Do we care about backends for this report?
	Sources struct {
		UsesSources   bool
		UsesFromEnv   bool
		UsesPG        bool
		UsesSQLServer bool
		UsesMySQL     bool
		UsesMongo     bool
	}

	Tables struct {
		UsesTables bool
		/* // These are actions on MD, not features:
		TrackModels bool
		TrackForeignKeys bool
		TrackFunctions bool
		*/
		CommentsOnModels bool
		EnumTables       bool
		ApolloFederation bool
	}

	Relationships struct {
		UsesRelationships                  bool
		LocalRelationshipWithForeignKey    bool
		LocalRelationshipWithoutForeignKey bool
		RemoteRelationship                 bool
	}

	QueriesAndMutations struct {
		UsesQueriesAndMutations    bool
		AutoGeneratedQueryFeatures bool
		QueryList                  bool
		QueryByPrimaryKey          bool
		DistinctOn                 bool
		UsesWhere                  bool
		// It may be difficult to determine this from metadata...
		Where struct {
			BasicUsage           bool
			WithBoolExpression   bool
			Operators            bool
			AggregateExpressions bool
		}
		Pagination              bool
		Limit                   bool
		Offset                  bool
		OrderBy                 bool
		Aggregate               bool
		UsesSimpleObjectQueries bool
		SimpleObjectQueries     struct {
			ScalarIntegerAndText   bool
			ScalarJSON             bool
			NestedObjects          bool
			AggregateNestedObjects bool
		}
		BoolExpressions bool
		Introspection   bool
		RunSQL          bool // N/A?
		UsesPermissions bool
		Permissions     struct {
			ColumnPermisisons bool
			PermissionRules   bool
		}
	}

	Actions struct {
		UsesActions bool
		Queries     bool
		Mutations   bool
		Types       struct {
			UsesTypes         bool
			CustomTypes       bool
			CustomScalarTypes bool
		}
		HttpConfiguration struct {
			ConfiguredEndpoints  bool
			URLTemplating        bool
			RequestMethod        bool
			StaticHeaders        bool
			DynamicHeaders       bool
			ForwardClientHeaders bool
		}
		AsyncActions bool
		/* /// Not part of configuration
		* Open API Import
			* Single Import
			* bulk import
			* error handling during import
			* support yaml & JSON
		* Code Gen
			* Support multiple programming languages & frameworks
		* Derive Actions
		*/
		BasicPermissions bool
		Relationships    struct {
			UsesRelationships bool
			ActionToDB        bool
			ActionToRS        bool
			ActionToAction    bool
		}
		Transforms struct {
			UsesTransforms    bool // Subsumes Kriti Feature.
			RequestTransforms struct {
				UsesRequestTransforms bool
				ContextObjects        bool
				RequestMethod         bool
				RequestURL            bool
				RequestBody           bool
			}
			ResponseTransforms struct {
				UsesResponseTransforms bool
				ContextObjects         bool
				DebuggingMode          bool
			}
			PayloadTransforms struct {
				UsesPayloadTransforms  bool
				ResponseBodyTransforms bool
			}
		}
		// * Async Action logs cleanup (?) // What's this?
	}

	RemoteSchemas struct {
		UsesRemoteSchemas bool
		Configuration     struct {
			UsesConfiguration bool
			FromEnv           bool
			Timeout           bool
			Headers           bool
			DynamicHeaders    bool
		}
		Relationships struct {
			UsesRelationships bool
			ToDatabase        bool
			ToRemoteSchema    bool
			ArgumentPresets   bool
		}
		Permissions bool
		BypassAuth  bool
	}

	EventTriggers struct {
		UsesEventTriggers bool
		Types             struct {
			Insert bool
			Update bool
			Delete bool
			// Via console: N/A?
			ColumnSpecificUpdates bool
		}
		TriggerProtocols struct {
			Webhook bool
		}
		// * Auto Cleanup Event Logs (Make sure event logs are cleared periodically): N/A?
		RequestTransforms struct {
			UsesRequestTransforms bool
			Headers               bool
			RequestMethod         bool
			RequestURL            bool
			RequestBody           bool
			Context               bool
		}
		ResponseTransforms struct {
			UsesResponseTransforms bool
		}
		PayloadTransform struct {
			ResponseBodyTransforms bool
		}
		RetryLogicConfiguration bool
		/* // N/A?
		* Simulation
			* Event triggers can be tested by manually triggering from console
		* Codegen
		* Observability
		* Performance
		*/
	}

	Authentication struct {
		UsesAuthentication bool
		JWTs               struct {
			UsesJWTs bool
			Secret   bool
			JWK      bool
		}
		Webhook              bool
		AdminRole            bool
		UnauthorisedAccess   bool
		MultipleAdminSecrets bool
		MultipleJWTs         bool
	}

	Authorization struct {
		RoleFromSessionVariable   bool
		RoleBasedSchemeGeneration bool
		ConfigureRowPermissions   bool
		ColumnPermissions         bool
		AggregationPermissions    bool
		RowFetchLimit             bool
		RootFieldVisibility       bool
		ColumnPresets             bool
		BackendOnlyMutations      bool
		PermissionsOperators      bool
		// PermissionsSummary (on Console): N/A?
	}

	Relay struct {
		UsesRelay bool
		Queries   struct {
			UsesQueries                 bool
			ConnectionObjectsNodesEdges bool
		}
		Subscriptions bool
		Mutations     bool
	}

	RESTifiedEndpoints struct {
		UsesRESTifiedEndpoints   bool
		BasicGraphql             bool
		ArgumentsFromPayloadBody bool
		ArgumentsFromURLParams   bool
		DifferentHTTPMethods     bool
		// * RESTified endpoint playground (like GraphiQL UI, to test REST endpoints): N/A?
	}

	/* // Not able to be detected from metadata:
	### Caching
	* Basic Caching with @cached
	* With Custom TTL @cached(ttl: 120)
	* forcing a refresh @cached(refresh: true)
	*/

	AllowLists struct {
		UsesAllowLists                          bool
		ConfigureQueryCollectionsWithRoleAccess bool
		MultipleQueryColectionsAndRoles         bool
		CachingMetrics                          bool // ??
		EnterpriseSuppport                      struct {
			UsesEnterpriseSuppport    bool
			CustomRedisConfigurations bool
		}
	}

	APILimits struct {
		UsesAPILimits bool
		RateLimits    bool
		DepthLimits   bool
		NodeLimits    bool
		TimeLimits    bool
		BatchLimits   bool
	}

	// How to detect this?
	DynamicEnvironmentVariables struct {
		UsesDynamicEnvironmentVariables bool
		ZeroDowntimeSecretResolution    bool
	}

	/* // N/A?
	### Other
	* Metadata Consistency
	* Schema Registry
	* Federation
		* Apollo Federation
	*/

	// The following may need to be detected in telemetry data:
	// --------------------------------------------------------

	Subscriptions struct {
		UsesSubscriptions bool
	}

	Observability struct {
		UsesOpenTelemetry bool
		MetricsURL        bool
		TracePropogation  bool
		Headers           bool
		Attrubutes        bool
		APMIntegrations   struct {
			Prometheus   bool
			Datadog      bool
			NewRelic     bool
			AzureMonitor bool
		}
		QueryTags bool
	}
}
